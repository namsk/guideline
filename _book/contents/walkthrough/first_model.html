<!DOCTYPE HTML>
<html lang="en-US" manifest="../../manifest.appcache">
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        <meta charset="UTF-8">
        <title>첫번째 모델의 생성 | 초보자를 위한 레일스 가이드라인(가제)</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="">
        <meta name="description" content="&quot;초보자를 위한 레일스 가이드라인(가제)&quot; 공동집필
이 책은 이제 막 루비온레일스를 시작하는 개발자를 대상으로 실무 프로젝트를 따라 하면서 루비온레일스의 전반적인 내용을 쉽게 이해할 수 있도록 내용을 구성하였다.">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        <link rel="next" href="../../contents/walkthrough/layout.html" />
        
        
        <link rel="prev" href="../../contents/walkthrough/welcome_controller.html" />
        

        <meta property="og:title" content="첫번째 모델의 생성 | 초보자를 위한 레일스 가이드라인(가제)">
        <meta property="og:site_name" content="초보자를 위한 레일스 가이드라인(가제)">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">
        
    </head>
    <body>
        

        <link rel="stylesheet" href="../../gitbook/style.css">
        


        
    <div class="book"  data-level="4.3" data-basepath="../.." data-revision="1399619043956">
    <div class="book-header">
    <!-- Actions Left -->
    
    <a href="#" class="btn pull-left toggle-summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
	<div class="dropdown-caret">
  <span class="caret-outer"></span>
  <span class="caret-inner"></span>
</div>

	<div class="btn-group btn-block">
		<button id="reduce-font-size" class="btn btn-default">A</button>
		<button id="enlarge-font-size" class="btn btn-default">A</button>
	</div>

	<ul class="list-group font-family-list">
		<li class="list-group-item" data-font="0">Serif</li>
		<li class="list-group-item" data-font="1">Sans</li>
	</ul>

	<div class="btn-group btn-group-xs btn-block color-theme-list">
	  <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
	</div>
</div>

    </span>

    <!-- Actions Right -->
    <a href="#" target="_blank" class="btn pull-right" data-sharing="google-plus"><i class="fa fa-google-plus"></i></a>
    <a href="#" target="_blank" class="btn pull-right" data-sharing="facebook"><i class="fa fa-facebook"></i></a>
    <a href="#" target="_blank" class="btn pull-right" data-sharing="twitter"><i class="fa fa-twitter"></i></a>

    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="../../" >초보자를 위한 레일스 가이드라인(가제)</a>
    </h1>
</div>

    <div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        <li data-level="0" data-path="index.html">
            <a href="../../"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
            <li  data-level="1" data-path="contents/authors.html">
                
                <a href="../../contents/authors.html">
                    <i class="fa fa-check"></i> <b>1.</b> 저자소개
                </a>
                
                
            </li>
        
            <li  data-level="2" data-path="contents/rubyonrails_intro.html">
                
                <a href="../../contents/rubyonrails_intro.html">
                    <i class="fa fa-check"></i> <b>2.</b> 루비온레일스 소개
                </a>
                
                
            </li>
        
            <li  data-level="3" data-path="contents/environments.html">
                
                <a href="../../contents/environments.html">
                    <i class="fa fa-check"></i> <b>3.</b> 환경 준비
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="3.1" data-path="contents/dev_env.html">
                            
                            <a href="../../contents/dev_env.html">
                                <i class="fa fa-check"></i> <b>3.1.</b> 개발환경
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.2" data-path="contents/rbenv.html">
                            
                            <a href="../../contents/rbenv.html">
                                <i class="fa fa-check"></i> <b>3.2.</b> rbenv 설치
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.3" data-path="contents/git.html">
                            
                            <a href="../../contents/git.html">
                                <i class="fa fa-check"></i> <b>3.3.</b> Git 설치
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.4" data-path="contents/railsinstall.html">
                            
                            <a href="../../contents/railsinstall.html">
                                <i class="fa fa-check"></i> <b>3.4.</b> 레일스 설치
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.5" data-path="contents/pro_env.html">
                            
                            <a href="../../contents/pro_env.html">
                                <i class="fa fa-check"></i> <b>3.5.</b> 운영환경
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="4" data-path="contents/walkthrough/start.html">
                
                <a href="../../contents/walkthrough/start.html">
                    <i class="fa fa-check"></i> <b>4.</b> 프로젝트 따라하기
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="4.1" data-path="contents/walkthrough/gemfile.html">
                            
                            <a href="../../contents/walkthrough/gemfile.html">
                                <i class="fa fa-check"></i> <b>4.1.</b> Gemfile의 작성
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.2" data-path="contents/walkthrough/welcome_controller.html">
                            
                            <a href="../../contents/walkthrough/welcome_controller.html">
                                <i class="fa fa-check"></i> <b>4.2.</b> welcome 컨트롤러의 생성
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.3" data-path="contents/walkthrough/first_model.html">
                            
                            <a href="../../contents/walkthrough/first_model.html">
                                <i class="fa fa-check"></i> <b>4.3.</b> 첫번째 모델의 생성
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.4" data-path="contents/walkthrough/layout.html">
                            
                            <a href="../../contents/walkthrough/layout.html">
                                <i class="fa fa-check"></i> <b>4.4.</b> 어플리케이션 레이아웃의 작성
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.5" data-path="contents/walkthrough/posts_CRUD.html">
                            
                            <a href="../../contents/walkthrough/posts_CRUD.html">
                                <i class="fa fa-check"></i> <b>4.5.</b> posts CRUD 살펴보기
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.6" data-path="contents/walkthrough/bulletin.html">
                            
                            <a href="../../contents/walkthrough/bulletin.html">
                                <i class="fa fa-check"></i> <b>4.6.</b> Bulletin 모델의 생성
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.7" data-path="contents/walkthrough/model_association.html">
                            
                            <a href="../../contents/walkthrough/model_association.html">
                                <i class="fa fa-check"></i> <b>4.7.</b> 모델 관계선언
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.8" data-path="contents/walkthrough/top_menu.html">
                            
                            <a href="../../contents/walkthrough/top_menu.html">
                                <i class="fa fa-check"></i> <b>4.8.</b> friendly_id 젬 사용하기
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.9" data-path="contents/walkthrough/posts_controller_modified.html">
                            
                            <a href="../../contents/walkthrough/posts_controller_modified.html">
                                <i class="fa fa-check"></i> <b>4.9.</b> posts 컨트롤러 변경
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.10" data-path="contents/walkthrough/posts_view_file.html">
                            
                            <a href="../../contents/walkthrough/posts_view_file.html">
                                <i class="fa fa-check"></i> <b>4.10.</b> posts 뷰 변경
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="5" data-path="deployment/first.html">
                
                <a href="../../deployment/first.html">
                    <i class="fa fa-check"></i> <b>5.</b> 프로젝트 배포하기
                </a>
                
                
            </li>
        
            <li  data-level="6" data-path="appendices/appendix.html">
                
                <a href="../../appendices/appendix.html">
                    <i class="fa fa-check"></i> <b>6.</b> 부록
                </a>
                
                
            </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 61.904761904761905%;min-width: 57.142857142857146%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../../contents/authors.html" title="저자소개" class="chapter done new-chapter" data-progress="1" style="left: 4.761904761904762%;"></a>
    
        <a href="../../contents/rubyonrails_intro.html" title="루비온레일스 소개" class="chapter done new-chapter" data-progress="2" style="left: 9.523809523809524%;"></a>
    
        <a href="../../contents/environments.html" title="환경 준비" class="chapter done new-chapter" data-progress="3" style="left: 14.285714285714286%;"></a>
    
        <a href="../../contents/dev_env.html" title="개발환경" class="chapter done " data-progress="3.1" style="left: 19.047619047619047%;"></a>
    
        <a href="../../contents/rbenv.html" title="rbenv 설치" class="chapter done " data-progress="3.2" style="left: 23.80952380952381%;"></a>
    
        <a href="../../contents/git.html" title="Git 설치" class="chapter done " data-progress="3.3" style="left: 28.571428571428573%;"></a>
    
        <a href="../../contents/railsinstall.html" title="레일스 설치" class="chapter done " data-progress="3.4" style="left: 33.333333333333336%;"></a>
    
        <a href="../../contents/pro_env.html" title="운영환경" class="chapter done " data-progress="3.5" style="left: 38.095238095238095%;"></a>
    
        <a href="../../contents/walkthrough/start.html" title="프로젝트 따라하기" class="chapter done new-chapter" data-progress="4" style="left: 42.857142857142854%;"></a>
    
        <a href="../../contents/walkthrough/gemfile.html" title="Gemfile의 작성" class="chapter done " data-progress="4.1" style="left: 47.61904761904762%;"></a>
    
        <a href="../../contents/walkthrough/posts_view_file.html" title="posts 뷰 변경" class="chapter done " data-progress="4.10" style="left: 52.38095238095238%;"></a>
    
        <a href="../../contents/walkthrough/welcome_controller.html" title="welcome 컨트롤러의 생성" class="chapter done " data-progress="4.2" style="left: 57.142857142857146%;"></a>
    
        <a href="../../contents/walkthrough/first_model.html" title="첫번째 모델의 생성" class="chapter done " data-progress="4.3" style="left: 61.904761904761905%;"></a>
    
        <a href="../../contents/walkthrough/layout.html" title="어플리케이션 레이아웃의 작성" class="chapter  " data-progress="4.4" style="left: 66.66666666666667%;"></a>
    
        <a href="../../contents/walkthrough/posts_CRUD.html" title="posts CRUD 살펴보기" class="chapter  " data-progress="4.5" style="left: 71.42857142857143%;"></a>
    
        <a href="../../contents/walkthrough/bulletin.html" title="Bulletin 모델의 생성" class="chapter  " data-progress="4.6" style="left: 76.19047619047619%;"></a>
    
        <a href="../../contents/walkthrough/model_association.html" title="모델 관계선언" class="chapter  " data-progress="4.7" style="left: 80.95238095238095%;"></a>
    
        <a href="../../contents/walkthrough/top_menu.html" title="friendly_id 젬 사용하기" class="chapter  " data-progress="4.8" style="left: 85.71428571428571%;"></a>
    
        <a href="../../contents/walkthrough/posts_controller_modified.html" title="posts 컨트롤러 변경" class="chapter  " data-progress="4.9" style="left: 90.47619047619048%;"></a>
    
        <a href="../../deployment/first.html" title="프로젝트 배포하기" class="chapter  new-chapter" data-progress="5" style="left: 95.23809523809524%;"></a>
    
        <a href="../../appendices/appendix.html" title="부록" class="chapter  new-chapter" data-progress="6" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_1921">
                    
                        <h1 id="-">첫번째 모델의 생성</h1>
<p><code>Post</code>라는 모델을 작성해 보자. 이 모델은 우선 title(글제목)과 content(글내용) 두개의 속성으로 구성하자. 나중에 필요한 속성을 추가하게 될 것이다. 커맨드라인에서 아래와 같이 명령을 실행하자.</p>
<pre><code>$ bin/rails generate scaffold Post title content:text
      invoke  active_record
      create    db/migrate/20140501054730_create_posts.rb
      create    app/models/post.rb
      invoke    test_unit
      create      test/models/post_test.rb
      create      test/fixtures/posts.yml
      invoke  resource_route
       route    resources :posts
      invoke  scaffold_controller
      create    app/controllers/posts_controller.rb
      invoke    erb
      create      app/views/posts
      create      app/views/posts/index.html.erb
      create      app/views/posts/edit.html.erb
      create      app/views/posts/show.html.erb
      create      app/views/posts/new.html.erb
      create      app/views/posts/_form.html.erb
      invoke    test_unit
      create      test/controllers/posts_controller_test.rb
      invoke    helper
      create      app/helpers/posts_helper.rb
      invoke      test_unit
      create        test/helpers/posts_helper_test.rb
      invoke    jbuilder
      create      app/views/posts/index.json.jbuilder
      create      app/views/posts/show.json.jbuilder
      invoke  assets
      invoke    coffee
      create      app/assets/javascripts/posts.js.coffee
      invoke    scss
      create      app/assets/stylesheets/posts.css.scss
      invoke  scss
      create    app/assets/stylesheets/scaffolds.css.scss
</code></pre><p>위에서 보는 바와 같이, 간단한 커맨드라인 명령으로 다양한 리소스 모듈들이 호출되고 연관 템플릿 파일들이 생성되었다. MVC(Model-View-Controller) 디자인 패턴에 따라 이 파일들을 분류해 볼 수 있는데, 우선 위의 실행 결과물의 세번째 줄에 있는 마이그레이션 파일 <code>20140501054730_create_posts.rb</code>에 주목하자. 이 파일의 내용은 아래와 같다. (<code>20140501054730</code> 값은 상황에 따라 다를 수 있다.)</p>
<pre><code>class CreatePosts &lt; ActiveRecord::Migration
  def change
    create_table :posts do |t|
      t.string :title
      t.text :content

      t.timestamps
    end
  end
end
</code></pre><p>이 파일은 <code>rake</code> 명령의 여러가지 <code>task</code> 중 <code>db:migrate</code> 작업을 실행할 때 <code>rake</code>가 이용하게 되며 데이터베이스 테이블을 생성한다. 이 때 테이블의 이름은 모델명(Post)의 복수형(posts)으로 자동 지정된다.</p>
<pre><code>$ bin/rake db:migrate
== 20140501054730 CreatePosts: migrating ======================================
-- create_table(:posts)
   -&gt; 0.0011s
== 20140501054730 CreatePosts: migrated (0.0012s) =============================
</code></pre><h2 id="-">마이그레이션 상태 확인</h2>
<p>이와 같은 마이그레이션 작업의 수행결과는 히스토리로 관리되는데 아래와 같이 커맨드라인 명령으로 확인할 수 있다.</p>
<pre><code>$ bin/rake db:migrate:status

database: /Users/user/rcafe/db/development.sqlite3

 Status   Migration ID    Migration Name
--------------------------------------------------
   up     20140501054730  Create posts
</code></pre><h3 id="-status-">상태(status)</h3>
<p>각 컬럼에 대해서 간략하게 설명하고 넘어가자.
<code>Status</code>는 마이그레이션의 상태를 나타낸다. <code>up</code>은 마이그레이션이 실행된 상태이고, <code>down</code>으로 표시된 경우는 아직 마이그레이션이 수행되지 않는 상태를 의미한다. 아래와 같이 방금 전에 수행했던 마이그레이션을 취소(롤백, rollback)해 보자.</p>
<pre><code>$ bin/rake db:rollback
== 20140501054730 CreatePosts: reverting ======================================
-- drop_table(:posts)
   -&gt; 0.0006s
== 20140501054730 CreatePosts: reverted (0.0033s) =============================
</code></pre><p>이 결과로 데이터베이스에서 <code>posts</code> 테이블이 <code>drop</code>된다. 그리고 마이그레이션 상태를 확인하면,</p>
<pre><code>$ bin/rake db:migrate:status

database: /Users/hyo/prj/r4/rcafe/db/development.sqlite3

 Status   Migration ID    Migration Name
--------------------------------------------------
  down    20140501054730  Create posts
</code></pre><h3 id="-id-migration-id-">마이그레이션 ID (Migration ID)</h3>
<p>이것은 마이그레이션 작업의 공유 번호다. 이 값은 마이그레이션 파일이 생성될 때 자동으로 파일명 앞에 붙는 타임스탬프로 공유한 값을 가진다. 예를 들어 위에서 마이그레이션에 사용된 <code>20140501054730_create_posts.rb</code> 파일의 파일명 시작부분에 있는 숫자가 이에 해당한다.</p>
<h3 id="-migration-name-">마이그레이션 이름(Migration Name)</h3>
<p>이것은 마이그레이션 파일명의 타임스탬프를 제외한 부분에서 발췌한 것이다.</p>
<h3 id="schema_migrations-">schema_migrations 테이블</h3>
<p>데이터베이스 마이그레이션 작업은 <code>version</code>이라는 하나의 속성만을 가지는 <code>schema_migrations</code>라는 테이블에 마이그레이션 ID 값이 저장된다. 위에서 언급했던 마이그레이션 상태(Status)는 해당 마이그레이션 ID 값이 <code>schema_migrations</code> 테이블에 존재할 때 <code>up</code> 상태로 표시되고 없을 경우에 <code>down</code> 상태로 표시된다. 이를 확인하기 위해서 레일스 DB 콘솔로 접근해서 해당 테이블의 값을 조회해 보자.</p>
<pre><code>$ bin/rails db
SQLite version 3.7.13 2012-07-17 17:46:21
Enter &quot;.help&quot; for instructions
Enter SQL statements terminated with a &quot;;&quot;
sqlite&gt; select version from schema_migrations;
20140501054730
</code></pre><h2 id="-">리소스 라우팅</h2>
<p>브라우저에서 <a href="http://localhost:3000/posts" target="_blank">http://localhost:3000/posts</a> 로 접근하면 아래와 같은 화면을 볼 수 있다.</p>
<p><img src="http://i1373.photobucket.com/albums/ag392/rorlab/Photobucket%20Desktop%20-%20RORLAB/rcafe/2014-05-09_08-10-08_zps09cc4c2c.png" alt="posts_index"></p>
<p>위에서 <code>Post</code> 모델을 scaffold 제너레이터를 이용하여 생성할 때 콘솔 출력내용 중 아래와 같은 부분을 발견할 수 있다.</p>
<pre><code>$ bin/rails generate scaffold Post title content:text
       ...
      invoke  resource_route
       route    resources :posts
       ...
</code></pre><p>즉, resource_route 모듈을 호출하여 config/routes.rb 파일에 <code>resources :posts</code> 라인을 추가한다. 이와 같이 라우팅을 선언하는 방법을 <code>리소스 라우팅</code>이라고 한다. 이로서 아래와 같은 라우팅을 사용할 수 있게 된다.</p>
<pre><code>$ bin/rake routes
   Prefix Verb   URI Pattern               Controller#Action
    posts GET    /posts(.:format)          posts#index
          POST   /posts(.:format)          posts#create
 new_post GET    /posts/new(.:format)      posts#new
edit_post GET    /posts/:id/edit(.:format) posts#edit
     post GET    /posts/:id(.:format)      posts#show
          PATCH  /posts/:id(.:format)      posts#update
          PUT    /posts/:id(.:format)      posts#update
          DELETE /posts/:id(.:format)      posts#destroy
     root GET    /                         welcome#index
</code></pre><p>따라서, 위와 같이 브라우저에서 <code>http://localhost:3000/posts</code>와 같이 요청하게 되면 디폴트로 HTTP GET 메소드에 매칭되는 URI 패턴을 찾아보게 된다. 결과적으로 <code>posts</code> 컨트롤러를 호출하여 <code>index</code> 액션을 실행하게 되고 최종적으로 <code>app/views/posts/</code> 디렉토리 상의  <code>index.html.erb</code> 뷰 템플릿을 렌더링하여 응답으로 보내게 된다.</p>
<p>브라우저 상에서 데이터를 추가, 삭제 변경해서 문제없이 잘 수행되는 것을 확인하자.</p>
<p>지금까지 scaffold 제너레이터를 이용하여 특별한 추가 코딩없이 최소한의 기능을 가진 게시물 작성 모듈을 작성할 수 있게 되었는데, 처음 레일스를 접하는 개발자들에게는 놀라운 일이다. 레일스는 이와 같이 개발자들이 기본적인 기능을 구현하기 위해서 추가하는 코딩을 대신해서 작성해 준다.</p>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../../contents/walkthrough/welcome_controller.html" class="navigation navigation-prev"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../../contents/walkthrough/layout.html" class="navigation navigation-next"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="../../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="../../gitbook/app.js"></script>
        

    
    <script src="../../gitbook/plugins/gitbook-plugin-mixpanel/plugin.js"></script>
    

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

    </body>
</html>
